# Organization Management Endpoints

'/organizations/mine':
  get:
    tags:
      - Organizations
    summary: Get current organization
    description: |
      Retrieves detailed information about the current user's organization.
      
      This endpoint returns comprehensive information about the organization
      the authenticated user belongs to, including profile, settings, and locations.
    operationId: getCurrentOrganization
    security:
      - bearerAuth: []
    responses:
      '200':
        description: Current organization details
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  $ref: '../components/schemas.yaml#/Organization'
      '401':
        $ref: '../components/responses.yaml#/Unauthorized'

'/organizations/mine/basic-info':
  patch:
    tags:
      - Organizations
    summary: Update organization basic information
    description: |
      Updates the basic information of the current organization.
      
      This endpoint allows administrators to update basic organization information
      such as name, type, contact email, contact phone, and website.
    operationId: updateOrganizationBasicInfo
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              name:
                type: string
                description: Organization name
              type:
                type: string
                enum: [referring, radiology, both]
                description: Organization type
              contactEmail:
                type: string
                format: email
                description: Primary contact email
              contactPhone:
                type: string
                description: Primary contact phone
              website:
                type: string
                format: uri
                description: Organization website
    responses:
      '200':
        description: Organization basic information updated successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  type: object
                  properties:
                    id:
                      type: string
                      description: Organization ID
                    name:
                      type: string
                      description: Organization name
                    type:
                      type: string
                      enum: [referring, radiology, both]
                      description: Organization type
                    contactEmail:
                      type: string
                      format: email
                      description: Primary contact email
                    contactPhone:
                      type: string
                      description: Primary contact phone
                    website:
                      type: string
                      format: uri
                      description: Organization website
                    updatedAt:
                      type: string
                      format: date-time
                      description: Date and time of the update
      '400':
        $ref: '../components/responses.yaml#/BadRequest'
      '401':
        $ref: '../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../components/responses.yaml#/Forbidden'

'/organizations/mine/address':
  patch:
    tags:
      - Organizations
    summary: Update organization address
    description: |
      Updates the address information of the current organization.
      
      This endpoint allows administrators to update the physical and mailing
      addresses of the organization.
    operationId: updateOrganizationAddress
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              address:
                $ref: '../components/schemas.yaml#/Address'
              mailingAddress:
                $ref: '../components/schemas.yaml#/Address'
              usePhysicalForMailing:
                type: boolean
                description: Whether to use physical address for mailing
    responses:
      '200':
        description: Organization address updated successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  type: object
                  properties:
                    id:
                      type: string
                      description: Organization ID
                    address:
                      $ref: '../components/schemas.yaml#/Address'
                    mailingAddress:
                      $ref: '../components/schemas.yaml#/Address'
                    updatedAt:
                      type: string
                      format: date-time
                      description: Date and time of the update
      '400':
        $ref: '../components/responses.yaml#/BadRequest'
      '401':
        $ref: '../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../components/responses.yaml#/Forbidden'

'/organizations/mine/billing-info':
  patch:
    tags:
      - Organizations
    summary: Update organization billing information
    description: |
      Updates the billing information of the current organization.
      
      This endpoint allows administrators to update billing information
      such as billing email, phone, address, and tax ID.
    operationId: updateOrganizationBillingInfo
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              billingEmail:
                type: string
                format: email
                description: Billing email
              billingPhone:
                type: string
                description: Billing phone
              billingAddress:
                $ref: '../components/schemas.yaml#/Address'
              taxId:
                type: string
                description: Tax ID/EIN
              usePhysicalForBilling:
                type: boolean
                description: Whether to use physical address for billing
    responses:
      '200':
        description: Organization billing information updated successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  type: object
                  properties:
                    id:
                      type: string
                      description: Organization ID
                    billingInfo:
                      type: object
                      properties:
                        billingEmail:
                          type: string
                          format: email
                          description: Billing email
                        billingPhone:
                          type: string
                          description: Billing phone
                        billingAddress:
                          $ref: '../components/schemas.yaml#/Address'
                        taxId:
                          type: string
                          description: Tax ID/EIN
                    updatedAt:
                      type: string
                      format: date-time
                      description: Date and time of the update
      '400':
        $ref: '../components/responses.yaml#/BadRequest'
      '401':
        $ref: '../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../components/responses.yaml#/Forbidden'

'/organizations/mine/specialties':
  put:
    tags:
      - Organizations
    summary: Update organization specialties
    description: |
      Updates the medical specialties of the current organization.
      
      This endpoint allows administrators to update the list of medical
      specialties offered or required by the organization.
    operationId: updateOrganizationSpecialties
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              specialties:
                type: array
                description: Array of specialty codes
                items:
                  type: string
            required:
              - specialties
    responses:
      '200':
        description: Organization specialties updated successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  type: object
                  properties:
                    id:
                      type: string
                      description: Organization ID
                    specialties:
                      type: array
                      description: Array of specialty codes
                      items:
                        type: string
                    updatedAt:
                      type: string
                      format: date-time
                      description: Date and time of the update
      '400':
        $ref: '../components/responses.yaml#/BadRequest'
      '401':
        $ref: '../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../components/responses.yaml#/Forbidden'

'/organizations/mine/settings':
  patch:
    tags:
      - Organizations
    summary: Update organization settings
    description: |
      Updates the settings of the current organization.
      
      This endpoint allows administrators to update organization settings
      such as default language, time zone, date format, and notification preferences.
    operationId: updateOrganizationSettings
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              settings:
                $ref: '../components/schemas.yaml#/OrganizationSettings'
    responses:
      '200':
        description: Organization settings updated successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  type: object
                  properties:
                    id:
                      type: string
                      description: Organization ID
                    settings:
                      $ref: '../components/schemas.yaml#/OrganizationSettings'
                    updatedAt:
                      type: string
                      format: date-time
                      description: Date and time of the update
      '400':
        $ref: '../components/responses.yaml#/BadRequest'
      '401':
        $ref: '../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../components/responses.yaml#/Forbidden'

'/organizations/mine/logo-upload-url':
  get:
    tags:
      - Organizations
    summary: Get logo upload URL
    description: |
      Generates a presigned URL for uploading an organization logo.
      
      This endpoint returns a presigned URL that can be used to upload
      an organization logo directly to the storage service.
    operationId: getLogoUploadUrl
    security:
      - bearerAuth: []
    responses:
      '200':
        description: Logo upload URL generated successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  type: object
                  properties:
                    presignedUrl:
                      type: string
                      format: uri
                      description: Presigned URL for uploading the logo
                    fileKey:
                      type: string
                      description: The key to use when confirming the upload
                    expiresIn:
                      type: integer
                      description: Expiration time for the URL in seconds
                      example: 3600
      '401':
        $ref: '../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../components/responses.yaml#/Forbidden'

'/organizations/mine/logo':
  post:
    tags:
      - Organizations
    summary: Set organization logo
    description: |
      Sets the logo for the current organization.
      
      This endpoint confirms the upload of an organization logo after it has been
      uploaded to the storage service using a presigned URL.
    operationId: setOrganizationLogo
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              fileKey:
                type: string
                description: The key of the uploaded file in the storage service
            required:
              - fileKey
    responses:
      '200':
        description: Organization logo set successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  type: object
                  properties:
                    logoUrl:
                      type: string
                      format: uri
                      description: URL for the uploaded logo
                    thumbnailUrl:
                      type: string
                      format: uri
                      description: URL for a thumbnail version of the logo
                    uploadDate:
                      type: string
                      format: date-time
                      description: Date the logo was uploaded
      '400':
        $ref: '../components/responses.yaml#/BadRequest'
      '401':
        $ref: '../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../components/responses.yaml#/Forbidden'
  
  delete:
    tags:
      - Organizations
    summary: Remove organization logo
    description: |
      Removes the logo for the current organization.
      
      This endpoint removes the organization's logo and reverts to the default logo.
    operationId: removeOrganizationLogo
    security:
      - bearerAuth: []
    responses:
      '200':
        description: Organization logo removed successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                message:
                  type: string
                  example: "Organization logo removed successfully"
      '401':
        $ref: '../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../components/responses.yaml#/Forbidden'

'/organizations/mine/request-verification':
  post:
    tags:
      - Organizations
    summary: Request organization verification
    description: |
      Requests verification for the current organization.
      
      This endpoint allows administrators to submit verification documents
      and request official verification of the organization.
    operationId: requestOrganizationVerification
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              documents:
                type: array
                description: Array of document IDs that have been previously uploaded
                items:
                  type: string
            required:
              - documents
    responses:
      '200':
        description: Verification request submitted successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  type: object
                  properties:
                    status:
                      type: string
                      enum: [pending]
                      description: Verification status
                    requestDate:
                      type: string
                      format: date-time
                      description: Date the verification was requested
                    documents:
                      type: array
                      description: Array of submitted documents
                      items:
                        type: string
                    nextReviewDate:
                      type: string
                      format: date-time
                      description: Expected date for the next review
      '400':
        $ref: '../components/responses.yaml#/BadRequest'
      '401':
        $ref: '../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../components/responses.yaml#/Forbidden'
      '409':
        description: Verification already in progress
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: false
                message:
                  type: string
                  example: "Verification request already in progress"

'/organizations/mine/verification-status':
  get:
    tags:
      - Organizations
    summary: Get verification status
    description: |
      Retrieves the verification status of the current organization.
      
      This endpoint returns the current status of the organization's
      verification process, including submitted documents and review dates.
    operationId: getVerificationStatus
    security:
      - bearerAuth: []
    responses:
      '200':
        description: Verification status
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  type: object
                  properties:
                    status:
                      type: string
                      enum: [pending, verified, rejected]
                      description: Verification status
                    requestDate:
                      type: string
                      format: date-time
                      description: Date the verification was requested
                    verificationDate:
                      type: string
                      format: date-time
                      description: Date the verification was completed (if verified)
                    rejectionReason:
                      type: string
                      description: Reason for rejection (if rejected)
                    documents:
                      type: array
                      description: Array of submitted documents
                      items:
                        type: string
                    nextReviewDate:
                      type: string
                      format: date-time
                      description: Expected date for the next review
      '401':
        $ref: '../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../components/responses.yaml#/Forbidden'
      '404':
        description: No verification request found
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: false
                message:
                  type: string
                  example: "No verification request found for this organization"

'/organizations/mine/deactivate':
  post:
    tags:
      - Organizations
    summary: Deactivate organization
    description: |
      Deactivates the current organization.
      
      This endpoint allows administrators to deactivate their organization,
      which will prevent all users from accessing the system.
    operationId: deactivateOrganization
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            properties:
              reason:
                type: string
                description: Reason for deactivation
            required:
              - reason
    responses:
      '200':
        description: Organization deactivated successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  type: object
                  properties:
                    id:
                      type: string
                      description: Organization ID
                    status:
                      type: string
                      enum: [inactive]
                      description: Updated organization status
                    deactivatedAt:
                      type: string
                      format: date-time
                      description: Date and time of deactivation
      '400':
        $ref: '../components/responses.yaml#/BadRequest'
      '401':
        $ref: '../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../components/responses.yaml#/Forbidden'

'/organizations/mine/reactivate':
  post:
    tags:
      - Organizations
    summary: Reactivate organization
    description: |
      Reactivates the current organization.
      
      This endpoint allows administrators to reactivate their organization
      after it has been deactivated.
    operationId: reactivateOrganization
    security:
      - bearerAuth: []
    responses:
      '200':
        description: Organization reactivated successfully
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  type: object
                  properties:
                    id:
                      type: string
                      description: Organization ID
                    status:
                      type: string
                      enum: [active]
                      description: Updated organization status
                    reactivatedAt:
                      type: string
                      format: date-time
                      description: Date and time of reactivation
      '401':
        $ref: '../components/responses.yaml#/Unauthorized'
      '403':
        $ref: '../components/responses.yaml#/Forbidden'
      '409':
        description: Organization is already active
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: false
                message:
                  type: string
                  example: "Organization is already active"

'/organizations/{organizationId}':
  get:
    tags:
      - Organizations
    summary: Get organization by ID
    description: |
      Retrieves an organization by its ID.
      
      This endpoint returns public information about a specific organization,
      which is useful for viewing potential connection partners.
    operationId: getOrganizationById
    security:
      - bearerAuth: []
    parameters:
      - name: organizationId
        in: path
        description: ID of the organization to retrieve
        required: true
        schema:
          type: string
    responses:
      '200':
        description: Organization details
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  $ref: '../components/schemas.yaml#/OrganizationPublic'
      '401':
        $ref: '../components/responses.yaml#/Unauthorized'
      '404':
        $ref: '../components/responses.yaml#/NotFound'

'/organizations/search':
  get:
    tags:
      - Organizations
    summary: Search organizations
    description: |
      Searches for organizations based on various criteria.
      
      This endpoint returns a paginated list of organizations matching the search criteria,
      which is useful for finding potential connection partners.
    operationId: searchOrganizations
    security:
      - bearerAuth: []
    parameters:
      - name: q
        in: query
        description: Search term for organization name
        schema:
          type: string
      - name: type
        in: query
        description: Filter by organization type
        schema:
          type: string
          enum: [referring, radiology, both]
      - name: state
        in: query
        description: Filter by state/province
        schema:
          type: string
      - name: specialty
        in: query
        description: Filter by specialty
        schema:
          type: string
      - name: page
        in: query
        description: Page number for pagination
        schema:
          type: integer
          minimum: 1
          default: 1
      - name: limit
        in: query
        description: Number of items per page
        schema:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
    responses:
      '200':
        description: Search results
        content:
          application/json:
            schema:
              type: object
              properties:
                success:
                  type: boolean
                  example: true
                data:
                  type: object
                  properties:
                    organizations:
                      type: array
                      items:
                        $ref: '../components/schemas.yaml#/OrganizationPublic'
                    pagination:
                      $ref: '../components/schemas.yaml#/Pagination'
      '401':
        $ref: '../components/responses.yaml#/Unauthorized'